<div class="card mb-5 mb-xl-10">
    <!--begin::Card header-->
    <div class="card-header d-flex p-2 ps-4">
        <div class="justify-content-start">

            <button type="button" class="btn btn-sm btn-default text-uppercase text-white me-3 mb-2 mt-2" style="background-color:#00B0F0;" *ngFor="let filter of searchCriteria.
                requestRegistrationProcessingSearch.registrationStatusList" (click)="onFilterClick('registrationStatusList',filter)">
                {{filter}} <i class="bi bi-x text-white"></i>
            </button>
            <button type="button" class="btn btn-sm btn-default text-uppercase text-white me-3 mb-2 mt-2" style="background-color:#00B0F0;" *ngFor="let filter of searchCriteria.
                requestRegistrationProcessingSearch.paymentStatusList" (click)="onFilterClick('paymentStatusList',filter)">
                {{filter}} <i class="bi bi-x text-white"></i>
            </button>
        </div>

        <div class="d-flex justify-content-end mb-2">
            <button type="button" class="btn btn-sm btn-link text-uppercase text-success fw-bold me-3 mb-2 mt-2">
                Records Selected: {{totalRecCount?.totalProjectSummary}}
            </button>
            <button class="btn btn-link btn-sm">     
                <i class="ki-duotone ki-arrows-circle fs-1 text-dark">
                <span class="path1"></span>
                <span class="path2"></span>
                </i>      
            </button>
        </div>

        <div class="d-flex justify-content-end mb-2">
          <div class="d-flex align-items-center position-relative my-1">
              <i class="ki-duotone ki-magnifier fs-3 position-absolute ms-3">
                  <span class="path1"></span>
                  <span class="path2"></span>
              </i>
              <input type="text"  matInput (keyup)="applyFilter($event)"  id="kt_filter_search" class="form-control form-select-sm w-400px ps-9" placeholder="Search">
          </div>
      </div>
    </div>
    <!--begin::Card header-->
    <!--begin::Content-->
    <div id="kt_account_settings_profile_details" class="collapse show">
        <!--begin::Form-->
        <form id="kt_account_profile_details_form" class="form fv-plugins-bootstrap5 fv-plugins-framework" novalidate="novalidate">
            <!--begin::Card body-->
            <div class="card-body border-top p-2">
                
                <div class="table-container table-responsive">
                    <table class="table table-striped table-hover table-row-bordered" mat-table [dataSource]="dataSource" matSort>

                        <!-- Checkbox Column -->
                        <ng-container matColumnDef="select">
                          <th mat-header-cell *matHeaderCellDef>
                            <mat-checkbox (change)="$event ? masterToggle() : null"
                                          [checked]="selection.hasValue() && isAllSelected()"
                                          [indeterminate]="selection.hasValue() && !isAllSelected()" >
                            </mat-checkbox>
                          </th>
                          <td mat-cell *matCellDef="let row">
                            <mat-checkbox (click)="$event.stopPropagation()"
                                          (change)="$event ? selection.toggle(row) : null"
                                          [checked]="selection.isSelected(row)" >
                            </mat-checkbox>
                          </td>
                        </ng-container>
                      
                        <!-- Position Column -->
                        <ng-container matColumnDef="familyId">
                          <th valign="middle" class="bold_txt" mat-header-cell *matHeaderCellDef mat-sort-header >Family Id</th>
                          <td valign="middle" mat-cell *matCellDef="let element"> {{element.familyId}}</td>
                        </ng-container>
                      
                        <!-- Name Column -->
                        <ng-container matColumnDef="primaryName">
                          <th valign="middle" class="bold_txt"  mat-header-cell *matHeaderCellDef  mat-sort-header>Primary Name</th>
                          <td valign="middle" mat-cell *matCellDef="let element"> {{element.primaryName}} </td>
                        </ng-container>
                      
                        <!-- Weight Column -->
                        <ng-container matColumnDef="registrationStatus">
                          <th valign="middle" class="bold_txt"  mat-header-cell *matHeaderCellDef  mat-sort-header> Registration Status </th>
                          <td valign="middle" mat-cell *matCellDef="let element"> {{element.registrationStatus}} </td>
                        </ng-container>
                      
                        <!-- Symbol Column -->
                        <ng-container matColumnDef="paymentStatus">
                          <th valign="middle" class="bold_txt"  mat-header-cell *matHeaderCellDef  mat-sort-header> Payment Status </th>
                          <td valign="middle" mat-cell *matCellDef="let element"> {{element.paymentStatus}} </td>
                        </ng-container>
                      
                        <ng-container matColumnDef="choiceDescription">
                            <th valign="middle" class="bold_txt"  mat-header-cell *matHeaderCellDef  mat-sort-header>Session Choice1 /Assigned Session</th>
                            <td valign="middle" mat-cell *matCellDef="let element"> {{element.choiceDescription}} </td>
                          </ng-container>

                          <ng-container matColumnDef="TemplateID">
                            <th valign="middle" class="bold_txt"  mat-header-cell *matHeaderCellDef mat-sort-header>Template ID & Preview</th>
                            <td valign="middle" mat-cell *matCellDef="let element"><a href="javascript:void(0);" (click)="previewTemplate(element);">Template</a></td>
                          </ng-container>

                          <ng-container matColumnDef="email">
                            <th valign="middle"  class="bold_txt"  mat-header-cell *matHeaderCellDef mat-sort-header>Email</th>
                            <td valign="middle" mat-cell *matCellDef="let element">{{element.email}}</td>
                          </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;">
                        </tr>
                      </table>
                        <mat-paginator #paginator 
                        (page)="handlePageEvent($event)"  [showFirstLastButtons]="paginationConfig.showFirstLastButtons"
                        [pageSizeOptions]="paginationConfig.pageSizeOptions"></mat-paginator>
                </div>
                
            </div>
            <!--end::Card body-->
        </form>
        <!--end::Form-->
        <!--begin::Actions-->
        <div class="card-footer d-flex justify-content-end py-6 px-9">
            <!--<a routerLink="/email-processing/email-search" href="/email-processing/email-search" class="btn btn-danger btn-sm me-2">
                <i class="icon-cancel-circle2 fs-4"></i> Cancel
            </a>-->

            <button type="button" class="btn btn-danger btn-sm m-1" routerLink="/email-processing/email-search" style="font-size: 13px;">
                <i class="icon-cancel-circle2 fs-6"></i> Cancel
            </button>

            <button (click)="sendEmail();" type="button" class="btn btn-primary btn-sm m-1" style="font-size: 13px;">
                <i class="icon-paperplane fs-6"></i> Send
            </button>
        </div>
        <!--end::Actions-->
    </div>
    <!--end::Content-->
</div>

<div class="templatePopup_wrap" *ngIf="showpopupFlag">
   <div class="overlay_template"></div>
   <div class="template_popup_window">
    <a href="javascript:void(0)" class="close_icon" (click)="closeTemplatePopup();">X</a>
    <h2>Template Preview</h2>
    <br/>
     <div [innerHtml]="popupTemplateData?.emailBody" class="email_template_cust"></div>
   </div>
</div>